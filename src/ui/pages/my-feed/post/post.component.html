<!-- post.component.html -->
<div class="post-container" *ngIf="postContent">
    <div class="post-card">
        <!-- Header -->
        <div class="post-header">
            <div class="user-info">
                <div class="profile-image">
                    <img [src]="postContent.getUserInfo().getProfilePic()" [alt]="postContent.getUserInfo().getUsername()">
                </div>
                <div class="user-details">
                    <div class="user-top-line">
                        <span class="username" (click)="goProfile()">{{postContent.getUserInfo().getUsername()}}</span>
                        <div class="preference-badge">
                            @if (postContent.getUserPreference()?.getType() === 'mentor') {
                                <i>üß†</i>
                            } @else if (postContent.getUserPreference()?.getType() === 'explorador') {
                                <i>üîç</i>
                            } @else if (postContent.getUserPreference()?.getType() === 'entusiasta') {
                                <i>üí°</i>
                            }
                            <span>{{postContent.getUserPreference()?.getTopicName()}}</span>
                        </div>
                    </div>
                    <span class="post-time">30 minutos ¬∑ @if (postContent.getPrivacy() === 'public') {
                        üåé}@else {
                            üîí
                        }</span>
                </div>
            </div>
            @if (postContent.getUserInfo().getUserId() === userId) {                
                <button class="options-button" (click)="toggleOptionsMenu($event)">‚Ä¢‚Ä¢‚Ä¢</button>
                @if (isOptionsMenuOpen) {
                    <div class="options-dropdown" (click)="$event.stopPropagation()">
                        <button 
                            class="dropdown-item"
                            (click)="editPublication()"
                        >
                            <i class="pi pi-pencil"></i> Editar publicaci√≥n
                        </button>
                        <button 
                            class="dropdown-item" 
                        >
                            <i class="pi pi-trash"></i> Eliminar publicaci√≥n
                        </button>
                    </div>
                }
            }
        </div>

        <!-- Content -->
        <div class="post-content" (click)="goToPost()"> 
            <p class="post-text">{{postContent.getContent()}}</p>
            @if (postContent.getMediaUrl()) {
                <div class="media-container">
                    <img [src]="postContent.getMediaUrl()" alt="Post media" class="post-media">
                </div>
            }
        </div>

        <!-- Actions -->
        <div class="post-actions">
            <button class="action-button" (click)="giveLike()">
                <i class="pi pi-heart" [ngClass]="postContent.isLiked() ? 'red' : 'no-red'"></i>
                @if (postContent.getCantLikes() > 0) {
                    <span>{{postContent.getCantLikes()}}</span>
                }
            </button>
            <button class="action-button" [routerLink]="['detail_post', postContent.getId()]">
                <i class="pi pi-comment"></i>
                @if (postContent.getCantComments() > 0) {
                    <span>{{postContent.getCantComments()}}</span>
                }
            </button>
            <button class="action-button">
                <i class="pi pi-share-alt"></i>
            </button>
        </div>
    </div>
</div>


@if(publicationEdit()){
    <app-modal-post [myUser]="userDemo" [editable]="true" [postContent]="postContent" [type]="'post'" (clickEvent)="editPublication()"></app-modal-post>
}