<!-- post.component.html -->
<div class="post-container" *ngIf="postContent">
    <div class="post-card">
        <!-- Header -->
        <div class="post-header">
            @if(postContent.getCommunityId()){
            <!-- <div class="user-info">
                <div class="profile-image">
                    <div class="group-image-overlay">
                        <img src="images/images.jpeg" alt="Group Image">
                    </div>
                    <img [src]="postContent.getUserInfo().getProfilePic()"
                        [alt]="postContent.getUserInfo().getUsername()">
                </div>
                <div class="user-details">
                    <div class="user-top-line">
                        <div class="group-name">
                            <p class="group">Grupo</p>
                            <span class="username">enriqueBuelna</span>
                        </div>
                        <div class="username-container">
                            <div class="preference-badge">
                                <i>ğŸ“</i>
                                <span>Preguntas y respuestas</span>
                            </div>
                        </div>
                    </div>
                    <span class="post-time">2 h Â· ğŸŒ</span>
                </div>
            </div> -->
            <div class="user-info">
                <div class="profile-container">
                    <img [src]="postContent.getCoverPicture()" class="profile-image">
                    <div class="group-image">
                        <img [src]="postContent.getUserInfo().getProfilePic()"
                            [alt]="postContent.getUserInfo().getUsername()" alt="Group Image">
                    </div>
                </div>
                <div class="user-details">
                    <div class="user-top-line">
                        <div class="group-name">
                            <p class="group">{{postContent.getNameComunity()}}</p>
                            <span class="username">{{postContent.getUserInfo().getUsername()}}</span>
                        </div>
                        <div class="preference-badge">
                            @if (postContent.getTypeCommunity() === 'questions') {
                            <i>ğŸ“</i>
                            <span>Preguntas y respuestas</span>
                            }@else if(postContent.getTypeCommunity() === 'resources-academic'){
                            <i>ğŸ“–</i>
                            <span>Recursos academicos</span>
                            }@else if (postContent.getTypeCommunity() === 'experiences') {
                            <i>ğŸ‘¨ğŸ½â€ğŸ’¼</i>
                            <span>Experiencias</span>
                            }@else if(postContent.getTypeCommunity() === 'opinions'){
                            <i>ğŸ—¯ï¸</i>
                            <span>Opiniones</span>
                            }@else if (postContent.getTypeCommunity() === 'resources-external') {
                            <i>ğŸ“¸</i>
                            <span>Recursos externos</span>
                            }
                        </div>
                    </div>
                    <span class="post-time">2 h Â· ğŸŒ</span>
                </div>
            </div>
            }@else {
            <div class="user-info">
                <div class="profile-image">
                    <img [src]="postContent.getUserInfo().getProfilePic()"
                        [alt]="postContent.getUserInfo().getUsername()">
                </div>
                <div class="user-details">
                    <div class="user-top-line">
                        <span class="username" (click)="goProfile()">{{postContent.getUserInfo().getUsername()}}</span>
                        <div class="preference-badge">
                            @if (postContent.getCommunityId()) {
                            @if (postContent.getTypeCommunity() === 'questions') {
                            <i>ğŸ“</i>
                            <span>Preguntas y respuestas</span>
                            }@else if(postContent.getTypeCommunity() === 'resources-academic'){
                            <i>ğŸ“–</i>
                            <span>Recursos academicos</span>
                            }@else if (postContent.getTypeCommunity() === 'experiences') {
                            <i>ğŸ‘¨ğŸ½â€ğŸ’¼</i>
                            <span>Experiencias</span>
                            }@else if(postContent.getTypeCommunity() === 'opinions'){
                            <i>ğŸ—¯ï¸</i>
                            <span>Opiniones</span>
                            }@else if (postContent.getTypeCommunity() === 'resources-external') {
                            <i>ğŸ“¸</i>
                            <span>Recursos externos</span>
                            }
                            }@else {
                            @if (postContent.getUserPreference()?.getType() === 'mentor') {
                            <i>ğŸ§ </i>
                            } @else if (postContent.getUserPreference()?.getType() === 'explorador') {
                            <i>ğŸ”</i>
                            } @else if (postContent.getUserPreference()?.getType() === 'entusiasta') {
                            <i>ğŸ’¡</i>
                            }
                            <span>{{postContent.getUserPreference()?.getTopicName()}}</span>
                            }
                        </div>
                    </div>
                    <span class="post-time">30 minutos Â· @if (postContent.getPrivacy() === 'public') {
                        ğŸŒ}@else {
                        ğŸ”’
                        }</span>
                </div>
            </div>
            }

            @if (postContent.getUserInfo().getUserId() === userId) {
            <button class="options-button" (click)="toggleOptionsMenu($event)">â€¢â€¢â€¢</button>
            @if (isOptionsMenuOpen) {
            <div class="options-dropdown" (click)="$event.stopPropagation()">
                <button class="dropdown-item" (click)="editPublication()">
                    <i class="pi pi-pencil"></i> Editar publicaciÃ³n
                </button>
                <button class="dropdown-item">
                    <i class="pi pi-trash"></i> Eliminar publicaciÃ³n
                </button>
            </div>
            }

            }@else if(amHost){
            <button class="options-button" (click)="toggleOptionsMenu($event)">â€¢â€¢â€¢</button>
            @if (isOptionsMenuOpen) {
            <div class="options-dropdown" (click)="$event.stopPropagation()">
                <button class="dropdown-item">
                    <i class="pi pi-trash"></i> Eliminar publicaciÃ³n
                </button>
            </div>
            }
            }
        </div>

        <!-- Content -->
        <div class="post-content" (click)="goToPost()">
            <p class="post-text">{{postContent.getContent()}}</p>
            @if (postContent.getMediaUrl()) {
            <div class="media-container">
                <img [src]="postContent.getMediaUrl()" alt="Post media" class="post-media">
            </div>
            }
        </div>

        <!-- Actions -->
        <div class="post-actions">
            <button class="action-button" (click)="giveLike()">
                <i class="pi pi-heart" [ngClass]="postContent.isLiked() ? 'red' : 'no-red'"></i>
                @if (postContent.getCantLikes() > 0) {
                <span>{{postContent.getCantLikes()}}</span>
                }
            </button>
            <button class="action-button" [routerLink]="['detail_post', postContent.getId()]">
                <i class="pi pi-comment"></i>
                @if (postContent.getCantComments() > 0) {
                <span>{{postContent.getCantComments()}}</span>
                }
            </button>
        </div>
    </div>
</div>


@if(publicationEdit() && type === 'profile'){
<app-modal-post [myUser]="userDemo" [editable]="true" [postContent]="postContent" [type]="'post'"
    (clickEvent)="editPublication()"></app-modal-post>
}@else if (publicationEdit() && type === 'group') {
<app-modal-post [myUser]="userDemo" [editable]="true" [postContent]="postContent" [type]="'group'"
    (clickEvent)="editPublication()"></app-modal-post>
}